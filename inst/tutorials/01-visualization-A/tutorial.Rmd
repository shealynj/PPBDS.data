---
title: "Visualization-A"
tutorial:
  id: "01-visualization-a"
output: 
  learnr::tutorial:
    progressive: true
    allow_skip: true
runtime: shiny_prerendered
description: "Chapter 1 Tutorial Part A"
---

<!-- SJ: first commit -->
<!-- 0) All summary comments from student feedback at top. --> 

<!-- 1) Go through this Rmd and add lots of comments/questions with your initials. -->

<!-- 2) Think about big picture questions of design. -->

<!-- 3) Tuesday night, submit pull request using pr_push(). Don't forget to run pr_pull_upstream(). -->


<!-- Ch. 1 tutorial questions written by Jessica Edwards, Connor Rust and Liam Rust  -->

<!-- Also includes questions from rstudio/learnr and rstudio-education/primers GitHub repos -->

<!-- is this working  -->

```{r setup, include=FALSE}
library(tidyverse)
library(PPBDS.data)
library(learnr)
library(shiny)
library(ggthemes)
library(viridis)
library(nycflights13)

knitr::opts_chunk$set(echo = FALSE, message = FALSE)
options(tutorial.exercise.timelimit = 60, tutorial.storage="local")  
```

## Welcome!

Welcome to your first Gov 50 tutorial on Chapter 1: Visualization! We hope that this tutorial will be a great opportunity for you to learn and dive deeper into the course material. Most of these tutorial questions will be exercises in which you can put your coding skills to the test to practice all of the cool visualization techniques you read about in Chapter 1, but you will also test your knowledge in multiple choice and short answer questions. Let's get started!!

## How do I code in R?


R is easiest to use when you know how the R language works. Some of the basic programming topics in R include the following:

* **functions** and their **arguments**
* **objects**
* R's basic **data types** 
* R's basic data structures like **vectors**
* R's **package system**

### Load a package

In the code chunk below, load the `tidyverse` package. Whenever you load a package R will also load all of the packages that the first package depends on. `tidyverse` takes advantage of this to create a shortcut for loading several common packages at once. Whenever you load `tidyverse`, `tidyverse` also loads `ggplot2`, `dplyr`, `tibble`, `tidyr`, `readr`, and `purrr`.

```{r packages2, exercise = TRUE}

```

### Quotes

Did you know, `library()` is a special function in R? You can pass `library()` a package name in quotes, like `library("tidyverse")`, or not in quotes, like `library(tidyverse)`---both will work! That's often not the case with R functions.

<!-- JSE - commented it out for now due to weird error, not sure how to remove "Run Code" button -->

<!-- ### Install packages -->

<!-- But what if the package that you want to load is not installed on your computer? How would you install the dplyr package on your own computer? -->

<!-- ```{r packages3, exercise = TRUE, exercise.eval = FALSE} -->

<!-- ``` -->

Load the `ggplot2` package using `library()`.

```{r exercise-1, exercise = TRUE, exercise.lines = 3}

```

### Functions 
Functions are the commands that perform tasks in R. They take in inputs called arguments and return outputs. 

Can you use the `sqrt()` function in the chunk below to compute the square root of 962?

```{r functions-1, exercise = TRUE}

```

Use the code chunk below to examine the code that `sqrt()` runs.

```{r functions-2, exercise = TRUE}
sqrt
```

Compare the code in `sqrt()` to the code in another R function, `lm()`. Examine `lm()`'s code body in the chunk below.

```{r functions-3, exercise = TRUE}
lm
```

### Help pages

Wow! `lm()` runs a lot of code. What does it do? Open the help page for `lm()` by using `?lm()` in the chunk below to find out.

```{r functions-4, exercise = TRUE}

```

### Code comments

 R will not run anything on a line after a `#` symbol. This is useful because it lets you write human readable comments in your code: just place the comments after a `#`. Now delete the `#` and re-run the chunk. You should see a result.

```{r functions-5, exercise = TRUE}
# sqrt(961)
```

### Objects

#### Object names

You can choose almost any name you like for an object, as long as the name does not begin with a number or a special character like `+`, `*`, `-`, `/`, `^`, `!`, `@`, or `&`. 

```{r objects-1, echo = FALSE}
question("Which of these would be valid object names?",
  answer("today", correct = TRUE),
  answer("1st"),
  answer("+1"),
  answer("vars", correct = TRUE),
  answer("\\^_^"),
  answer("foo", correct = TRUE),
  allow_retry = TRUE,
  correct = "Remember that the most helpful names will remind you what you put in your object."
)
```

#### Using objects

In the code chunk below, save the results of `rnorm(100, mean = 100, sd = 15)` to an object named `data`. Then, on a new line, call the `hist()` function on `data` to plot a histogram of the random values. Can you guess what the function does? Run the code a second time.

```{r objects-2, exercise=TRUE}

```

#### What if?

What do you think would happen if you assigned `data` to a new object named `copy`, like this? Run the code and then inspect both `data` and `copy`.

```{r objects-3, exercise=TRUE}
data <- rnorm(100, mean = 100, sd = 15)
copy <- data
```

#### Data sets

Objects provide an easy way to store data sets in R. In fact, R comes with many toy data sets pre-loaded. Examine the contents of `iris` to see a classic toy data set. Hint: use '?iris' to learn more.



```{r objects-4, exercise = TRUE}

```

#### A common error

```{r packages1, echo = FALSE}
question('What does this common error message suggest? `object _____ does not exist.`',
         answer("You misspelled your object name"),
         answer("You've forgot to load the package that ____ comes in"),
         answer("Either", correct = TRUE),
         allow_retry = TRUE)
```

### Vectors

A vector is a series of values. These are created using the c() function. 

```{r types5, echo = FALSE}
question('How many types of data can you put into a single vector?',
         answer("1", correct = TRUE),
         answer("6"),
         answer("As many as you like"),
         allow_retry = TRUE)
```


##### Create a vector
In the chunk below, create a vector that contains the integers from one to ten.

```{r vectors-1, exercise = TRUE}

```

```{r vectors-1-hint, eval=FALSE}
c(...)
```

`:`

If your vector contains a sequence of contiguous integers, you can create it with the `:` shortcut. Run `1:10` in the chunk below. What do you get? What do you suppose `1:20` would return?

```{r vectors-2, exercise = TRUE}

```

`[]`

You can extract any element of a vector by placing a pair of brackets behind the vector. Inside the brackets place the number of the element that you'd like to extract. For example, `vec[3]` would return the third element of the vector named `vec`.

Use the chunk below to extract the fourth element of `vec`.

```{r vectors-3, exercise = TRUE}
vec <- c(1, 2, 4, 8, 16)
```



You can also use `[]` to extract multiple elements of a vector. Place the vector `c(1,2,5)` between the brackets below. What does R return?

```{r vectors-4, exercise = TRUE}
vec <- c(1, 2, 4, 8, 16)
vec[]
```

#### Names

If the elements of your vector have names, you can extract them by name. To do so place a name or vector of names in the brackets behind a vector. Surround each name with quotation marks, e.g. `vec2[c("alpha", "beta")]`.

Extract the element named gamma from the vector below.

```{r vectors-5, exercise = TRUE}
vec2 <- c(alpha = 1, beta = 2, gamma = 3)
```

#### Vectorized operations

Predict what the code below will return. Then look at the result.

```{r vectors-6, exercise = TRUE}
c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10) + c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
```

#### Vector recycling

Predict what the code below will return. Then look at the result.

```{r vectors-7, exercise = TRUE}
1 + c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
```

### Data types
 
```{r flights3, echo = FALSE}
flights
``` 
 
Did you notice that a row of three (or four) letter abbreviations appears under the column names of `flights`? These abbreviations describe the _type_ of data that is stored in each column of `flights`:

* `int` stands for integers.

* `dbl` stands for doubles, or real numbers.

* `chr` stands for character vectors, or strings.

* `dttm` stands for date-times (a date + a time).

There are three other common types of variables that aren't used in this data set but are used in other data sets:

* `lgl` stands for logical, vectors that contain only `TRUE` or `FALSE`.

* `fctr` stands for factors, which R uses to represent categorical variables
  with fixed possible values.

* `date` stands for dates.

This row of data types is unique to tibbles and is one of the ways that tibbles try to be more user-friendly than data frames.



#### Character or object?

One of the most common mistakes in R is to call an object when you mean to call a character string and vice versa.

```{r types6, echo = FALSE}
question('Which of these are object names? What is the difference between object names and character strings?',
         answer("foo", correct = TRUE),
         answer('"num"'),
         answer("mu", correct = TRUE),
         answer('"sigma"'),
         answer('"data"'),
         answer("a", correct = TRUE),
         allow_retry = TRUE,
         correct = "Character strings are surrounded by quotation marks, object names are not.")
```



## Data Frames
Data frames are “spreadsheet”-type datasets.You can make a data frame with the `data.frame()` function, which works similar to `c()`.

Assemble the vectors below into a data frame with the column names `numbers`, `logicals`, `strings`.

```{r lists4, exercise = TRUE}
nums <- c(1, 2, 3, 4)
logs <- c(TRUE, TRUE, FALSE, TRUE)
strs <- c("apple", "banana", "carrot", "duck")
```
### Extract a column

Extract the strings column of the `df` data frame below.
```{r lists5, exercise = TRUE}
nums <- c(1, 2, 3, 4)
logs <- c(TRUE, TRUE, FALSE, TRUE)
strs <- c("apple", "banana", "carrot", "duck")
df <- data.frame(numbers = nums, logicals = logs, strings = strs)
```
### Exploring dataframes

#### `trains` data set

Load the `PPBDS.data` package to look at the `trains` data set.

###

```{r exercise-2, exercise = TRUE, exercise.lines = 5}

  
trains
```

###

Use the `glimpse()` function to look at the `trains` data set. We already loaded the `tidyverse` and `PPBDS.data` packages.

```{r exercise-4, exercise = TRUE, exercise.lines = 5}
library(tidyverse)
library(PPBDS.data)


```

###

```{r quiz-4, echo = FALSE}
quiz(caption = "Quiz - `trains` data set",
  question("What is the data type of the `liberal` variable?",
           answer("character"),
           answer("logical", correct = TRUE),
           answer("double"),
           answer("factor"),
           allow_retry = TRUE
  ),
  question("How many rows does the `train` data set have?",
           answer("8"),
           answer("15"),
           answer("115", correct = TRUE),
           allow_retry = TRUE
  )
)
```

Extract the `income` variable in the `trains` data set using the `$` operator.

```{r exercise-5, exercise = TRUE}

```

#### `qscores` data set

Look at the `qscores` data set using `glimpse()`. We have loaded the `PPBDS.data` and the `tidyverse` packages.

```{r qscores, exercise = TRUE, exercise.lines = 5}

```






## Grammar of graphics

```{r quiz-6, echo = FALSE}
quiz(
  question("What are the three essential components of a graphic?",
           answer("the data set containing the variables in question", correct = TRUE),
           answer("the geometric object we can observe in a plot", correct = TRUE),
           answer("axes labels on a plot"),
           answer("the aesthetic attributes", correct = TRUE),
           allow_retry = TRUE
  ),
  question("What are the two important arguments that we need to provide the `ggplot()` function?",
           answer("`data` and `mapping`", correct = TRUE),
           answer("`data` and `aesthetics`"),
           answer("`data` and `layers`"),
           allow_retry = TRUE
  )
)
```

### Components of a scatterplot

Look at this scatterplot made using the `trains` data set. Higher numbers mean more conservative attitudes toward immigration-related policies on a 3 to 15 scale. Individuals with a treatment value of "Treated" were exposed to two Spanish-speakers on their regular commute. "Control" individuals were not.

```{r trains}
ggplot(data = trains, mapping = aes(x = att_start, y = att_end, color = treatment)) +
  geom_point() + facet_wrap(~party)
```

```{r quiz-7, echo = FALSE}
quiz(
  question("Which `data` variable is mapped to the `x`-position `aes`thetic of the points?",
           answer("`att_start`", correct = TRUE),
           answer("`att_end`"),
           answer("`treatment`"),
           allow_retry = TRUE
  ),
  question("Which `data` variable is mapped to the `y`-position `aes`thetic of the points?",
           answer("`att_start`"),
           answer("`att_end`", correct = TRUE),
           answer("`treatment`"),
           allow_retry = TRUE
  ),
  question("Which `data` variable is mapped to the `color` `aes`thetic of the points?",
           answer("`att_start`"),
           answer("`att_end`"),
           answer("`treatment`", correct = TRUE),
           allow_retry = TRUE
  )
)
```

## ` geom_point` 

###

### Exercise 1
<!-- I -->


Let's make a scatterplot using the `iris` data set. Hit the 'Run Code' button.

```{r gp-1-1, exercise=TRUE, eval=FALSE}
ggplot(data = iris, mapping = aes(x = Petal.Length, y = Petal.Width)) + 
  geom_point()
```

Great! Now try making a scatterplot with x = `Sepal.Length` and y = `Sepal.Width`.

```{r gp-1-2-hint, eval=FALSE}
ggplot(data = iris, mapping = aes(x = ..., y = ...)) + 
  geom_point()
```

```{r gp-1-2, exercise=TRUE, exercise.lines = 5}
  

```

###

Excellent work! Now let's make a scatterplot with `Sepal.Length` on the x-axis, and `Petal.Length` on the y-axis. 

```{r gp-1-3, exercise=TRUE, exercise.lines = 5}
  

```

###
### Exercise 2

Wonderful. Now use what you've learned to recreate the plot below.

```{r}
ggplot(
  data = iris, mapping = aes(x = Petal.Width, y = Sepal.Width)) +
    geom_point() + 
    labs(title = "Petal and Sepal Widths in Irises")
```

```{r gp-1-5-hint, eval=FALSE}
To create a title, use labs(title = ...).
```

```{r gp-1-5, exercise=TRUE, exercise.lines = 5}
  

```

<!-- ## `geom_point()` II -->
### Exercise 3

Now let's make a scatterplot using the `qscores` data set. Load the `PPBDS.data` package and look at the `qscores` data set by simply typing the name of the data set.

```{r exercise-6, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-6-hint, eval=FALSE}
library(...)

...
```

###

Nice! Load the `ggplot2` package. Use the `ggplot()` function to create a scatterplot using the `qscores` data set, `rating` on the x-axis and `hours` on the y-axis. Is there a relationship between the rating of a Harvard course versus the average hours per week of workload?

```{r exercise-7, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-7-hint, eval=FALSE}
library(...)

ggplot(data = qscores, mapping = aes(x = ..., y = ...)) +
  ...
```

###

Awesome! Now we want to add a `size` `aes`thetic based on the number of students enrolled in each course. Add `size = enrollment` to the other `aes`thetics of the points. Do larger classes have a higher average overall course rating? What about higher workload?

```{r exercise-8, exercise = TRUE, exercise.lines = 5}
ggplot(data = qscores, mapping = aes(x = rating, y = hours)) +
  geom_point()
```

```{r exercise-8-hint, eval=FALSE}
ggplot(data = qscores, mapping = aes(x = rating, y = hours, size = ...)) +
  geom_point()
```

<!-- ## `geom_point()` III -->

###
### Exercise 4
For the data set `sps`, make a scatterplot with `age` on the x-axis and `health_exp_3m` on the y-axis.

```{r point-I-2, exercise=TRUE, exercise.lines=5}

```


```{r point-I-2-hint, eval=FALSE}
ggplot(data = sps, mapping = aes(x = ..., y = ...)) +
  geom_point()
```

###

Nice job! As you can see, our plot has many overlapping points making it hard to tell what's going on. Let's change the opacity by setting the `alpha` argument to 0.1.

```{r point-I-3, exercise=TRUE, exercise.lines=8, eval=FALSE}
ggplot(data = sps, mapping = aes(x = age, y = health_exp_3m)) +
  geom_point()
```

```{r point-I-3-hint, eval=FALSE}
Set the alpha argument inside of geom_point()
```

###

Great! Now try mapping the `sex` variable to the `color` aesthetic.

```{r point-I-4, exercise=TRUE, exercise.lines=10, eval=FALSE}
ggplot(data = sps, mapping = aes(x = age, y = health_exp_3m)) +
  geom_point()
```

```{r point-I-4-hint, eval=FALSE}
ggplot(aes(x = age, y = health_exp_3m, color = ...))

```

<!-- ## `geom_point()` IV -->
### Exercise 5

**Overplotting**

While this plot created using the `mpg` data set only displays 126 points, it visualizes a data set that contains 234 points.

```{r echo = FALSE, out.width = "80%"}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point()
```

The missing points are hidden behind other points, a phenomenon known as _overplotting_. Overplotting is a problem because it provides an incomplete picture of the data set. You cannot determine where the *mass* of the points fall, which makes it difficult to spot relationships in the data. 

**Causes of overplotting**

Overplotting usually occurs for two different reasons:

1. The data points have been rounded to a "grid" of common values, as in the plot above
2. The data set is so large that it cannot be plotted without points overlapping each other

How you deal with overplotting will depend on the cause. 

**Changing the transparency**

If your overplotting is due to rounding, you can obtain a better picture of the data by making each point semi-transparent. For example you could _set_ the alpha aesthetic of the plot below to a _value_ less than one, which will make the points transparent. 

Try this now. Set the points to an alpha of 0.2, which will make each point 20% opaque (i.e. five points staked on top of each other will create a solid black).

### Exercise 6
Change the transparency of the points by setting `alpha = 0.2` within `geom_point()`.

```{r exercise-9, exercise = TRUE, exercise.lines = 5}
ggplot(data = qscores, mapping = aes(x = rating, y = hours, size = enrollment)) +
  geom_point()
```

```{r exercise-9-hint, eval=FALSE}
ggplot(data = qscores, mapping = aes(x = rating, y = hours, size = enrollment)) +
  geom_point(alpha = ...)
```

##`geom_jitter()` 
<!-- I -->

A second strategy for dealing with overplotting due to rounding is to adjust the position of each point. `geom_jitter()` plots a scatterplot and then adds a small amount of random noise to each point in the plot. It is a shortcut for adding a "jitter" position adjustment to a points plot (i.e, `geom_point(position = "jitter")`). Since the noise is random, it is unlikely that two points rounded to the same location will also be jittered to the same location. The result is a jittered plot that displays more of the data and provides a simple way to inspect patterns that occur in heavily gridded or overlapping data. 

Replace `geom_point()` with `geom_jitter()` to create a jittered scatterplot.

```{r exercise-10, exercise = TRUE, exercise.lines = 5}
ggplot(data = qscores, mapping = aes(x = rating, y = hours)) +
  geom_point()
```

**Strategies for large data**

Alpha and jittering are less useful for large data. Jittering will not separate the points, and a mass of transparent points can still look black.

A better way to deal with overplotting due to large data is to visualize a summary of the data, by using a histogram or a linegraph, for example.

<!-- ## `geom_jitter()` II -->

###

Do you notice anything wrong with this graph? It appears to look fine, right? Try replacing `geom_point()` with `geom_jitter()`.

```{r jit-I-1, exercise=TRUE, exercise.lines=6}
ggplot(data = trains, mapping = aes(x = att_start, y = att_end)) +
  geom_point()

```

###

As you can see, this changes things. The data on our graph was affected by overplotting, which is where points are plotted on top of each other. Jittering the points shifted them slightly from under each other. We can adjust the amount the points are jittered by setting the width. Set the `width` to `.2` within `geom_jitter()`.

```{r jit-I-3, exercise=TRUE, exercise.lines=6}
ggplot(data = trains, mapping = aes(x = att_start, y = att_end)) +
  geom_jitter()

```
###

Now set the `color` aesthetic to the `party` variable. 

```{r jit-I-4, exercise=TRUE, exercise.lines=6}
ggplot(data = trains, mapping = aes(x = att_start, y = att_end)) +
  geom_jitter()

```


```{r jit-I-4-hint, eval=FALSE}
Because color is an aesthetic, set it inside of aes().
```

<!-- ## `geom_jitter()` III -->

Hit 'Run Code' to look at the following graph:

```{r gj-1-1, exercise=TRUE, exercise.lines = 5}
ggplot(data = diamonds, mapping = aes(x = carat, y = price)) +
  geom_jitter()
```

###

`geom_jitter()` is really useful in graphs with a lot of overplotting like the one we just made, because it moves points that occupy the same location on the graph around so they're more visible. That being said, our graph still has a lot of overplotting.

Let's try to fix this by setting `width` to 0.25, to widen our jitter effect.

```{r gj-1-2, exercise=TRUE, exercise.lines = 5}
ggplot(data = diamonds, mapping = aes(x = carat, y = price)) +
  geom_jitter()
```

###

Very nice, this gives us a bit of a better sense of the total distribution. But, there's still a lot of overplotting. Let's set the `alpha` value of our points to 0.2, so we can get a bit of a better grasp on our graph.

```{r gj-1-3, exercise=TRUE, exercise.lines = 5}
ggplot(data = diamonds, mapping = aes(x = carat, y = price)) +
  geom_jitter()
```

###
### Exercise 1
Nice. Now, use what you've learned to recreate the plot below. The `alpha` of the plot is 0.2, and the `width` of the jitter distribution is 5.

```{r}
ggplot(data = diamonds, mapping = aes(x = depth, y = price)) +
  geom_jitter(width = 5, alpha = 0.2) +
  labs(title = "Depth and Price in Diamonds",
       x = "Depth",
       y = "Price")
```

```{r gj-1-5, exercise=TRUE, exercise.lines = 5}

```

## `geom_line()` 
<!-- I -->

###

```{r, include = FALSE}
cces_data <- cces %>%
  filter(approval_ch %in% c("Approve / Somewhat Approve", "Disapprove / Somewhat Disapprove")) %>%
  group_by(year, approval_ch) %>%
  summarize(avg_age = mean(age))
```

The `cces` data set in the `PPBDS.data` package has been changed to show the average age of voters per year based on their approval of the president that year. The `cces` data set was manipulated using the `filter()`, `group_by`, and `summarize()` functions within the `tidyverse` package, which you will learn how to use in the next chapter.

```{r, echo = TRUE}
cces_data
```
### Exercise 1
Use the `ggplot()` function to create a linegraph with the data set called `cces_data` with `year` on the x-axis, `avg_age` on the y-axis, and `approval_ch` as the color aesthetic.

```{r exercise-11-setup, include = FALSE}
cces_data <- cces %>%
  filter(approval_ch %in% c("Approve / Somewhat Approve", "Disapprove / Somewhat Disapprove")) %>%
  group_by(year, approval_ch) %>%
  summarize(avg_age = mean(age))
```

```{r exercise-11, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-11-hint, eval=FALSE}
ggplot(data = cces_data, mapping = aes(x = ..., y = ..., color = ...)) +
  geom_line()
```

###


```{r quiz-8, echo = FALSE}
quiz(
  question("True / False: Linegraphs and scatterplots both display the relationship between two numerical variables.",
           answer("True", correct = TRUE),
           answer("False"),
           allow_retry = TRUE),
  question("True / False: It is preferred to use scatterplots over linegraphs when the variable on the x-axis has an inherent ordering, like in a time series plot.",
           answer("True"),
           answer("False", correct = TRUE),
           allow_retry = TRUE)
)
```

<!-- ## `geom_line()` II -->

###
### Exercise 2
Run the following line graph, then try changing the y axis variable to `unemploy`.

```{r line-I-2, exercise=TRUE, exercise.lines=6, eval=FALSE}
ggplot(data = economics, mapping = aes(x = date, y = pop)) +
  geom_line()
```

###

Nice! As you can see, we have filtered the data set `population` by `country` to create the new data frame `Afghanistan_population` which only includes data on Afghanistan. Use `Afghanistan_population` to create a line graph with `year` on the x axis and `population` (a variable that happens to have the same name as the data set) on the y axis.

```{r line-I-3, exercise=TRUE, exercise.lines=10}
Afghanistan_population <- population %>%
  filter(country == "Afghanistan")

```

```{r line-I-3-hint, eval=FALSE}
Afghanistan_population <- population %>%
  filter(country == "Afghanistan")

ggplot(data = ..., mapping = aes(x = ..., y = ...)) +
  geom_line()
```

###

Now change the line color to "purple"

```{r line-I-4, exercise=TRUE, exercise.lines=10}
Afghanistan_population <- population %>%
  filter(country == "Afghanistan")


```

```{r line-I-4-hint, eval=FALSE}

Set the color argument in geom_line() to "purple"

```

###

Great! For a final challenge, add a title and labels to both axes

```{r line-I-5, exercise=TRUE, exercise.lines=10}
Afghanistan_population <- population %>%
  filter(country == "Afghanistan")


```

```{r line-I-5-hint, eval=FALSE}
Use labs()

```

## ` geom_histogram()` 
<!-- I -->



```{r quiz-9, echo = FALSE}
quiz(
  question("A histogram is:",
           answer("A plot that displays the relationship between two numerical variables"),
           answer("A plot that visualizes the distribution of a numerical variable", correct = TRUE),
           answer("A plot that visualizes the distribution of a categorical variable"),
           allow_retry = TRUE)
)
```

###
### Exercise 1
Using the `qscores` data set and `ggplot()`, make a histogram where `rating` is on the x-axis to see the distribution of Harvard course ratings.

```{r exercise-12, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-12-hint, eval=FALSE}
ggplot(data = ..., mapping = aes(x = ...)) + ...
```

```{r quiz-10, echo = FALSE}
quiz(
  question_text("What is the default value of `bins` for this histogram? (Hint: all geoms have the same default values)",
                answer("30", correct = TRUE),
                allow_retry = TRUE)
)
```

###

Add white vertical borders demarcating the bins by adding `color = "powderblue"` and `fill = "red4"` arguments to `geom_histogram()`.

```{r exercise-13, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-13-hint, eval=FALSE}
ggplot(data = qscores, mapping = aes(x = rating)) +
  geom_histogram(color = ..., fill = ...)
```

###

Specify the number of bins to be 10 via the `bins` argument and the `color` as "white" in `geom_histogram()`.

```{r exercise-14, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-14-hint, eval=FALSE}
ggplot(data = qscores, mapping = aes(x = rating)) +
  geom_histogram(bins = ..., color = ...)
```

###

Specify the width of the bins to be 1 via the `binwidth` argument and the `color` as "white" in `geom_histogram()`.

```{r exercise-15, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-15-hint, eval=FALSE}
ggplot(data = qscores, mapping = aes(x = rating)) +
  geom_histogram(binwidth = ..., color = ...)
```

<!-- ## `geom_histogram()` II -->

###
### Exercise 2
Let's make a histogram using geom_histogram() and the `mpg` tibble, which contains data on the fuel efficiency of different types of cars. Press 'Run Code' to continue.

```{r gh-1-1, exercise=TRUE, exercise.lines = 5}
ggplot(data = mpg, mapping = aes(x = hwy)) +
  geom_histogram()
```

###

Great. Note that if you don't specify the number of 'bins' you want for your histogram, R will generate a red message, even though there isn't an error.

###

Now, try making a histogram with x = `cty`.

```{r gh-1-2-hint, eval=FALSE}
ggplot(data = mpg, mapping = aes(x = ...)) +
  geom_histogram()
```

```{r gh-1-2, exercise=TRUE, exercise.lines = 5}

```

###

Nice! Now, let's get rid of that pesky red message by setting `bins` to 40.

```{r gh-1-3-hint, eval=FALSE}
ggplot(data = mpg, mapping = aes(x = ...)) +
  geom_histogram(bins = ...)
```

```{r gh-1-3, exercise=TRUE, exercise.lines = 5}

```

###
### Exercise 3
Very nice. Now, use what you've learned to recreate this graph.

```{r}
ggplot(data = mpg, mapping = aes(x = displ)) +
  geom_histogram(bins = 10) +
  labs(title = "Engine Size in Cars",
       x = "Engine Size (Liters)",
       y = "Number of Car Models")
```


```{r gh-1-5-hint, eval=FALSE}
Engine size is recorded with the `displ` variable, and there are 10 bins in the plot.
Use labs(title = ..., x = ..., y = ...) to add the labels.
```

```{r gh-1-5, exercise=TRUE, exercise.lines = 7}

```

## `geom_boxplot()` 
###

Pick the one or two sentences from the book which best introduce this topic. Give the plot we will build.

### Exercise 1

```{r quiz-11, echo = FALSE}
quiz(
  question("Which of the following are included in the five-number summary of a numerical variable used to construct a boxplot?",
           answer("Minimum", correct = TRUE),
           answer("First quartile", correct = TRUE),
           answer("Median", correct = TRUE),
           answer("Mean"),
           answer("Third quartile", correct = TRUE),
           answer("Maximum", correct = TRUE)
  )
)
```


### Exercise 2

Create a boxplot using the trains data in which party is on the x-axis and age is on the y-axis.

```{r exercise-16, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-16-hint, eval=FALSE}
ggplot(data = ..., mapping = aes(x = ..., y = ...)) +
  ...
```





### Exercise 3

Let's make a boxplot using the `mpg` tibble, which shows the fuel efficiency for different types of cars. Set x = `class`, and y = `hwy`.

```{r gb-1-2, exercise=TRUE, exercise.lines = 5}

```



```{r gb-1-2-hint, eval=FALSE}
ggplot(data = mpg, mapping = aes(x = ... , y = ... )) +
  geom_boxplot()
```
###

Nice! Now let's add some labels using the `labs()` function. Title the plot "Highway Fuel Efficiency in Different Types of Cars". Set x = "Type of Car" and y = "Miles Per Gallon (Highway)".

```{r gb-1-4, exercise=TRUE, exercise.lines = 5}

```

```{r gb-1-4-hint, eval=FALSE}
labs(title = ...,
     x = ...,
     y = ...)
```


###
### Exercise 4
Awesome! Now, use what you've learned to recreate this plot.

```{r}
ggplot(data = mpg, 
       mapping = aes(x = manufacturer, y = cty)) +
  geom_boxplot(outlier.color = "blue") +
  labs(title = "City Fuel Efficiency by Car Manufacturer",
       x = "Manufacturer",
       y = "Miles Per Gallon (City)")
```

```{r gb-1-5, exercise=TRUE, exercise.lines = 5}

```

## `geom_violin()` 
###
A violin plot is a compact display of a continuous distribution which blends geom_boxplot() and geom_density()...these two come later don't worry. It is a mirrored density plot, and it is displayed in the same way as a boxplot. The mirrored density distribution in geom_violin() replaces the box and whiskers in boxplot.



### 
### Exercise 1
Let's use `geom_violin()` to make a plot with the `diamonds` tibble, which contains information about cut diamonds. Hit 'Run Code' to continue.

```{r gv-1-1, exercise=TRUE, exercise.lines = 5}
ggplot(data = diamonds, mapping = aes(x = cut, y = price)) +
  geom_violin()
```

###

Nice. Now, let's try changing the `color`, or outline, of our plot to "red" and the `fill` of the plots to "red3" within `geom_violin()`.

```{r gv-1-2, exercise=TRUE, exercise.lines = 5}

```

###

Cool. Now, let's use `draw_quantiles` to draw percentile lines on our violins, at 0.25, 0.5, and 0.75. `draw_quantiles` is an argument that goes within the `geom_violin()` function.

```{r gv-1-4-hint, eval=FALSE}
draw_quantiles = c(..., ..., ...)
```

```{r gv-1-4, exercise=TRUE, exercise.lines = 5}

```

###
### Exercise 2
Well done. Now, use what you've learned about `geom_violin()` to recreate this plot:

```{r}
ggplot(data = diamonds, mapping = aes(x = cut, y = carat), color = "blue") +
  geom_violin() +
  labs(title = "Size and Quality in Diamonds",
       x = "Quality",
       y = "Size (Carats)")
```

```{r gv-1-5, exercise=TRUE, exercise.lines = 5}

```

```{r gv-1-5-hint, eval=FALSE}
aes(x = cut, y = carat)

labs(title = ..., x = ..., y = ...)
```

## `geom_bar()`

###

```{r quiz-13, echo = FALSE}
quiz(
  question("A barplot is:",
           answer("A plot that displays the relationship between two numerical variables"),
           answer("A plot that visualizes the distribution of a numerical variable"),
           answer("A plot that visualizes the distribution of a categorical variable",
                  correct = TRUE),
           allow_retry = TRUE)
)
```

###

We can now use a barplot to plot how many students are enrolled in classes per department. We will use the `top_five_qscores` data set again to look at the five largest departments.

```{r barplot, include = FALSE}
top_five_enrolled <- qscores %>%
  group_by(department) %>%
  summarize(enrollment = sum(enrollment)) %>%
  arrange(desc(enrollment)) %>%
  pull(department)

top_five_qscores <- qscores %>% filter(department %in% top_five_enrolled[0:5])
```

```{r barplot-top-five-qscores, echo = TRUE}
top_five_qscores
```
### Exercise 1
Use `ggplot()` and `geom_bar()` to plot `department` on the x-axis to see the number of classes in each department.

```{r exercise-17-setup, include = FALSE}
top_five_enrolled <- qscores %>%
  group_by(department) %>%
  summarize(enrollment = sum(enrollment)) %>%
  arrange(desc(enrollment)) %>%
  pull(department)

top_five_qscores <- qscores %>% filter(department %in% top_five_enrolled[0:5])
```

```{r exercise-17, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-17-hint, eval=FALSE}
ggplot(data = ..., mapping = aes(x = ...)) +
  ...
```

###
### Exercise 2
Let's go back to the `trains` data set in the `PPBDS.data` package. Use `ggplot()` and `geom_bar()` to plot `treatment` on the x-axis.

```{r exercise-19, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-19-hint, eval=FALSE}
ggplot(data = ..., mapping = aes(x = ...)) + ...
```

###

We can now map the additional variable `party` by adding a `fill = party` inside the `aes()` aesthetic mapping.


```{r exercise-20, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-20-hint, eval=FALSE}
ggplot(data = trains, mapping = aes(x = treatment, fill = ...)) + 
  geom_bar()
```

###

Change `fill = party` to `color = party`. 

```{r exercise-21, exercise = TRUE, exercise.lines = 5}

```

###

Create a side-by-side barplot by adding `position = "dodge"` to `geom_bar()`.

```{r exercise-22, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-22-hint, eval=FALSE}
ggplot(data = trains, mapping = aes(x = treatment, fill = party)) +
  geom_bar(position = ...)
```

###

Instead of mapping `party` to `fill`, we can include it as the variable to create small multiples of the plot across the levels of `party` using `facet_wrap(~ party)`. Add this layer to the provided plot in order to create a faceted barplot.

<!-- ggplot(data = trains, mapping = aes(x = treatment)) + -->
<!--   geom_bar() -->

```{r exercise-23, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-23-hint, eval=FALSE}
ggplot(data = trains, mapping = aes(x = treatment)) + geom_bar() + ...
```

###
### Exercise 3
Wonderful! Now, use what you've learned to recreate the plot below.

```{r gbr-1-5, exercise=TRUE, exercise.lines = 5}

```

```{r gbr-1-5-hint, eval=FALSE}
aes(x = party, fill = liberal)
labs(title = ..., x = ..., y = ...)
```

```{r}
ggplot(data = trains, mapping = aes(x = party, fill = liberal)) +
  geom_bar() +
  labs(title = "Political Distribution on Boston Train Platform",
       x = "Political Party", y = "Number of People")
```

###
### Exercise 4
Let's now look at the data set `diamonds`, one you should already be familiar with. Press "Run Code".

```{r bar-I-1, exercise=TRUE, exercise.lines=7}
ggplot(data = diamonds, aes(x = color)) +
  geom_bar()
```

###

Now change the x-axis variable to `cut` and run code the code chunk.

```{r bar-I-2, exercise=TRUE, exercise.lines=7}


```

```{r bar-I-2-hint, eval=FALSE}
ggplot(data = diamonds, mapping = aes(x = ...)) +
  geom_bar()
```

###

Nice! Now try mapping the `fill` aesthetic to the `clarity` variable to create a stacked barplot.

```{r bar-I-3, exercise=TRUE, exercise.lines=7}


```

```{r bar-I-3-hint, eval=FALSE}
Because we are mapping fill to a variable, it is an aesthetic. This means that is has to be mapped inside of aes().
```

###

Great! Now try creating a dodged barplot by setting the `positon` argument to "dodge".

```{r bar-I-4, exercise=TRUE, exercise.lines=7}


```

```{r bar-I-4-hint, eval=FALSE}
Set position inside geom_bar() and remember to put "dodge" in quotes.
```

###
### Exercise 5
```{r}
ggplot(data = cces, mapping = aes(x = ideology, fill = gender)) +
  geom_bar(position = "dodge")
```

For your final challenge, recreate the above dodged bar graph. Note that it uses the `cces` data, not the `trains` data.

```{r bar-I-5, exercise=TRUE, exercise.lines=7}


```

## `geom_col()`

###

`geom_col()` makes barplots just like `geom_bar()`. The key difference between the two is the type of data they use. Here, We use `geom_col()` because the totals for a variable are pre-counted and listed in the data set. Also note that, unlike for `geom_bar()`, we have to include both x and y in the aesthetic. We'll practice using `geom_col()` in this section.

Let's return to the first barplot we made in `geom_bar()` using the five largest departments in the `qscores` data set. We will now count the number of classes per department in order to use the `geom_col()` layer instead. We do this using the `group_by()` and `count()` functions in the `tidyverse` package. Our new data frame is stored as `top_five_qscores_counted`.

```{r classes-counted, include = FALSE}
top_five_qscores_counted <- top_five_qscores %>%
  group_by(department) %>% count() %>% rename(count = n)
```

```{r avg-workload, echo = TRUE}
top_five_qscores_counted
```
### Exercise 1
Use `ggplot()` and `geom_col()` to plot `department` on the x-axis and `count` on the y-axis to see the number of classes in each department.

```{r exercise-18-setup, include = FALSE}
top_five_enrolled <- qscores %>%
  group_by(department) %>%
  summarize(enrollment = sum(enrollment)) %>%
  arrange(desc(enrollment)) %>%
  pull(department)

top_five_qscores <- qscores %>% filter(department %in% top_five_enrolled[0:5])

top_five_qscores_counted <- top_five_qscores %>%
  group_by(department) %>% count() %>% rename(count = n)
```


```{r exercise-18, exercise = TRUE, exercise.lines = 5}

```

```{r exercise-18-hint, eval=FALSE}
ggplot(data = top_five_qscores_counted, mapping = aes(x = ..., y = ...)) +
  ...
```

###

```{r quiz-14, echo = FALSE}
quiz(
  question("What's the difference between `geom_bar()` and `geom_col()`?",
           answer("`geom_bar()` is used to represent pre-counted data while `geom_col() is not."),
           answer("`geom_col()` is used to represent pre-counted data while `geom_bar() is not.",
                  correct = TRUE),
           answer("There is no difference between the two layers.")
  )
)
```

###
### Exercise 2
Let's keep working with the `qscores` data set. Press "Run Code" to check out the graph:

```{r col-I-1, exercise=TRUE, exercise.lines=7}
aframer_qscores <- qscores %>%
  filter(department == "AFRAMER")

ggplot(data = aframer_qscores, mapping = aes(x = number, y = enrollment)) +
  geom_col()
```

###

Let's make this graph a little more interesting. Map the `color` aesthetic to the `term` variable.

```{r col-I-2, exercise=TRUE, exercise.lines=7}
aframer_qscores <- qscores %>%
  filter(department == "AFRAMER")



```

```{r col-I-2-hint, eval=FALSE}
ggplot(data = aframer_qscores, mapping = aes(x = number, y = enrollment, color = ...)) +
  geom_col()

```

###
### Exercise 3
This final question is for all you Star Wars fans out there. These are the droids you're looking for. Recreate the plot below using the data set `droid`, which was created from filtering the `starwars` data set to only characters who are droids.

```{r}
droid <- starwars %>%
  filter(species == "Droid")

ggplot(data = droid, mapping = aes(x = name, y = height)) +
  geom_col()
```

```{r col-I-5, exercise=TRUE, exercise.lines=7, eval=FALSE}
droid <- starwars %>%
  filter(species == "Droid")


```

## `geom_smooth()` 

###
### Exercise 1
Let's start by creating a scatterplot from `nhanes`, which includes data from a national health and nutrition survey. Press "Run Code":

```{r smooth-I-1, exercise=TRUE, exercise.lines=7}
ggplot(data = nhanes, mapping = aes(x = weight, y = height)) +
  geom_point()

```

###

Now try adding `geom_smooth()` to the graph.

```{r smooth-I-2, exercise=TRUE, exercise.lines=7, eval=FALSE}
ggplot(data = nhanes, mapping = aes(x = weight, y = height)) +
  geom_point()


```

###

Nice! As you can see, the line you just graphed represents the trend that we see in the scatter plot. See the message that R gave us? Because we didn't set the method that R uses to calculate the line, R defaulted to using "gam". Let's try setting the method to "lm" instead.

```{r smooth-I-3, exercise=TRUE, exercise.lines=7}


```

```{r smooth-I-3-hint, eval=FALSE}
Set the method inside of geom_smooth() and remember to put "lm" in quotes.
```

###

Great! Now get rid of the scatterplot by deleting `geom_point()` and only use `geom_smooth()`. Then, set the `color` aesthetic to the `gender` variable.

```{r smooth-I-4, exercise=TRUE, exercise.lines=7}


```

```{r smooth-I-4-hint, eval=FALSE}
Because color is an aesthetic, set it inside of aes().
```

###

Nice! Now add the the title "Height to Weight Relationship United States" and labels "Height in cm" to the y axis and "Weight in kg" to the x axis.

```{r smooth-I-5, exercise=TRUE, exercise.lines=7}


```

```{r smooth-I-5-hint, eval=FALSE}
Use labs() to add the title and labels.
```

###
### Exercise 2
Let's make a plot with `geom_smooth()`, and the `mpg` tibble, which records the fuel efficiency of different car models. Hit 'Run Code' to continue.

```{r gs-1-1, exercise=TRUE, exercise.lines = 5}
ggplot(data = mpg, mapping = aes(x = displ, y = cty)) +
  geom_smooth()
```

###

Nice. Now, let's make the gray confidence interval bar disappear by setting `se` to `FALSE`in the geom_smooth() function.



```{r gs-1-2, exercise=TRUE, exercise.lines = 5}

```

###

Looks good! Let's add some labels with labs(). We can call our plot "Engine Size and City Fuel Efficiency", our x-axis "Engine Size (Liters)", and our y-axis "City Fuel Efficiency (Miles Per Gallon)"

```{r gs-1-3, exercise=TRUE, exercise.lines = 5}

```

###

Nicely done. Now, let's try dividing up our trendline by mapping `color` to `class`, so we can get a better sense of the range of fuel efficiency in different types of cars.

```{r gs-1-4, exercise=TRUE, exercise.lines = 5}

```

###
### Exercise 3
Great! Now, use what you've learned about `geom_smooth()` to recreate the plot below.

```{r}
ggplot(data = mpg, mapping = aes(x = cty, y = hwy)) +
  geom_smooth(color = "red") +
  labs(title = "City vs. Highway Fuel Economy",
       x = "City Miles Per Gallon",
       y = "Highway Miles Per Gallon")
```

```{r gs-1-5, exercise=TRUE, exercise.lines = 5}

```

## `geom_density()`

###
### Exercise 1
Just like histograms, density plots give us a sense of the distribution of a data set for a given variable.  Let's start by looking at this density plot from data set `nhanes`. Press "Run Code":

```{r den1D-I-1, exercise=TRUE, exercise.lines=6}
ggplot(data = nhanes, mapping = aes(x = bmi)) +
  geom_density()
```

###

Now try switching the axes by setting `bmi` to the y axis instead.

```{r den1D-I-2, exercise=TRUE, exercise.lines=6}

```

###

Great! Now change the variable to `height` and set it to the x axis.

```{r den1D-I-3, exercise=TRUE, exercise.lines=6}

```

###

Nice! Just like in a violin plot, we can use the `adjust` argument inside of `geom_density()` to change the bandwidth of our plot. Try setting it to 1/3, which makes it a third of the size of the default.

```{r den1D-I-4, exercise=TRUE, exercise.lines=6}

```

###

Great! Now set the `fill` aesthetic to the `gender` variable.

```{r den1D-I-5, exercise=TRUE, exercise.lines=7}

```

```{r den1D-I-5-hint, eval=FALSE}
Because fill is an aesthetic, set it inside of aes().
```

###
### Exercise 2
Now we'll look at the data set `cces`. Use `cces` to make a density plot with `age` on the x axis and `ideology` set to the aesthetics `color` and `fill`.

```{r den1D-II-1, exercise=TRUE, exercise.lines=6}


```

###

Great! As you can see, we have a lot of overlapping going on. Try setting the `alpha` parameter in `geom_density()` to 0.3.

```{r den1D-II-2, exercise=TRUE, exercise.lines=6}


```

###

Nice! Now try setting the `position` parameter in `geom_density()` to "fill". Then try setting it to "stack".

```{r den1D-II-3, exercise=TRUE, exercise.lines=7}


```

###

Great! Now add a limit to the x axis with an upper bound of 90 and a lower bound of 20. After you have done this, set the `linetype` parameter in `geom_density()` to `"dotted"`.

```{r den1D-II-4, exercise=TRUE, exercise.lines=8}


```

```{r den1D-II-4-hint, eval=FALSE}
Use xlim() to add a limit on the x axis
```

###
### Exercise 3
For your final challenge of `geom_density()`, recreate the graph below made with data set `trains`.

```{r}
ggplot(data = trains, mapping = aes(x = age, fill = liberal)) +
  geom_density(alpha = 0.5) +
  labs(title = "Age Distribution in Attitudes Toward Immigration Study")
```

```{r den1D-II-5, exercise=TRUE, exercise.lines=8}


```



## The `tidyverse`

Look at all of the awesome plots you created!! Now it's time to learn more about data wrangling using the `tidyverse`. We'll go over the following functions in this tutorial:

* **filter()** a data frame’s existing rows by only picking a subset of them.
* **select()** specific variable columns in a data set. Additional functions like **slice()** can further subset the data.
* **arrange()** its rows. For example, sort the rows of weather in ascending or descending order of temp.
* **group_by()** its rows. In other words, assign different rows to be part of the same group. We can then combine **group_by()** with **summarize()** to report summary statistics for each group separately. 
* **mutate()** its existing columns/variables to create new ones. 

###
### Exercise 1
Before we get started, load the `tidyverse` collection of packages and the package `PPBDS.data`.

```{r data-I-1, exercise=TRUE, exercise.lines=3}

```

###
### Exercise 2
Let's take a `glimpse()` at the data set `cces`. Press "Run Code".

```{r data-I-2, exercise=TRUE, exercise.lines=3}
glimpse(cces)
```

###

Now that you've seen the different variables in `cces`, `select()` `age`, `state`,  and `gender`

```{r data-I-3, exercise=TRUE, exercise.lines=3}
cces
```

```{r data-I-3-hint, eval=FALSE}
remember to pipe!
```

###

Let's `filter()` our code from the previous question so that we are only looking at rows where `state == "Massachusetts"` and `gender == "Female"`.

```{r data-I-4, exercise=TRUE, exercise.lines=10}


```

```{r data-I-4-hint, eval=FALSE}
remember to use the double ==
```

###

Now use `arrange()` to organize our code by descending order of age.

```{r data-I-5, exercise=TRUE, exercise.lines=10}

```

```{r data-I-5-hint, eval=FALSE}
remember to include desc()
```

###

Great! Now use `summarize()` to find the mean and median ages from our filtered data.

```{r data-I-6, exercise=TRUE, exercise.lines=10}

```

###
### Exercise 3
Let's recap what we just did. We first selected specific variables to focus on and then filtered to narrow down our search. We then arranged by descending order of age. From that data, we found the mean and median age with `summarize()`. Through these steps, we found the mean and median ages of women from Massachusetts in the survey. With these next couple questions, you will be doing this yourself. Find the mean age of liberal men from California:

```{r data-I-7, exercise=TRUE, exercise.lines=10}

```

```{r data-I-7-hint,eval=FALSE}
If some of the values apply to unfamiliar variables, feel free to always take a glimpse() back at the data set
```

###

Did you get 47.2? If so, awesome job! If not, look back at your code. For this next one, find the median age of divorced female Texans who attended "Some College":

```{r data-I-8, exercise=TRUE, exercise.lines=10}

```

###

The correct answer is 56. If you got something different, look back at your code. Great job!

###
### Exercise 4
For this section, we will be focusing on a really big data set called `nhanes`. let's say we wanted to make a graph using data on `height` and `weight` from the 200 youngest black males. We first would `select()` the variables we want to focus on, in this case `height`, `weight`, `age`, `race`, and `gender`. Try doing this below:

```{r data-II-1, exercise=TRUE, exercise.lines=10}


```

###

So what would we do next? We want to narrow down our data to only black males, so let's use `filter()` to create a tibble made up of rows from `nhanes` where `race == "Black"` and `gender == "Male"`. Do this below:

```{r data-II-2, exercise=TRUE, exercise.lines=10}


```

###

Great! So what now? Well, we want to look at the youngest black males. To do this, we would have to `arrange()` by age. Do this below:

```{r data-II-3, exercise=TRUE, exercise.lines=10}


```

###

Nice! Now use `slice()` to isolate the 200 rows with the lowest age value.

```{r data-II-4, exercise=TRUE, exercise.lines=10}


```

```{r data-II-4-hint-1, eval=FALSE}

Because of the way we arranged the data, the 200 rows with the lowest age value would be the first 200

```

```{r data-II-4-hint-2, eval=FALSE}

slice(1:200)

```

###

Awesome! We now have our tibble! Now use `geom_smooth()` to create a graph with `weight` on the x axis and `height` on the y axis.

```{r data-II-5, exercise=TRUE, exercise.lines=10}


```

```{r data-II-5-hint, eval=FALSE}
... %>% ggplot(aes(x = weight, y = height)) + geom_smooth()

```

###
### Exercise 5
Now we are going to be focusing on the data set `qscores`, which includes data on Harvard courses from the 2018-19 school year. Let's start by grouping `qscores` by `department`.

```{r data-III-1, exercise=TRUE, exercise.lines=3}

```

###

Now use `summarize()` to find the mean rating for each of `department` in our grouped tibble.

```{r data-III-2, exercise=TRUE, exercise.lines=6}

```

###

Nice! Now use `arrange()` to order our data by `desc`ending mean rating.

```{r data-III-3, exercise=TRUE, exercise.lines=6}


```

###

Great! As you can see, the tibble we have just created lists the different departments at Harvard included in `qscores` and their average rating. Let's say we wanted to make a plot with only the top 10 average rated departments. We would need to make a tibble to do this right? Use `slice()` to create this tibble.

```{r data-III-4, exercise=TRUE, exercise.lines=6}


```

###

Fantastic! Now use this tibble you created to make a bar plot with `department` on the x axis and `mean` on the y axis (notice how are new tibble uses variables not in `qscores`)

```{r data-III-5, exercise=TRUE, exercise.lines=6}


```

###

Awesome! Let's start fresh from the original `qscores` data set again. Word just came in that Harvard is switching to a rating scale out of 10 for the next term! Upper admin wants to be able to compare data from last year to the next term, so use `mutate()` to add the new variable `rating_2` equal to two times the variable `rating` in `new_qscores`. We have started it for you:

```{r data-III-6, exercise=TRUE, exercise.lines=6, eval=FALSE}
new_qscores <- qscores %>%


```

###

Now use `summarize()` to find the standard deviation of `rating_2`

```{r data-III-7, exercise=TRUE, exercise.lines=6, eval=FALSE}
new_qscores <- qscores %>%
  mutate(rating_2 = rating * 2)

new_qscores %>%


```

###
### Exercise 6
Great! Now let's play around with the `airquality` data set, which measures different atmospheric measurements in New York. Select `Month`, `Day`, and `Temp` from the data set.

```{r da-1-2, exercise=TRUE, exercise.lines = 5}
airquality
```

###

Now, let's use `glimpse()` on our data set to take a good look at it.

```{r da-1-3, exercise=TRUE, exercise.lines = 5}
airquality %>%
  select(Month, Day, Temp)
```

###

Great, now, use what you've learned from the textbook to calculate the average of the `Temp` variable. Let's call this value `average`.

```{r da-1-4, exercise=TRUE, exercise.lines = 5}
airquality %>%
  select(Month, Day, Temp)
```

###

Nice job! Finally, use everything you've learned so far to calculate the maximum Temp value of every month. We can call this variable `maxTemp`. Then, sort them from the highest value to the lowest (descending order).

```{r da-1-5-hint, eval=FALSE}
You will use group_by(...) and arrange(desc()). If you are having more trouble, refer to the textbook.
```

```{r da-1-5, exercise=TRUE, exercise.lines = 5, eval=FALSE}
airquality %>%
  select(Month, Day, Temp)
```

###
### Exercise 7
Let's do some data wrangling with the `mpg` tibble, which contains fuel efficiency data on different types of cars. Let's start by loading the data set, and using `select()` to pick out the `cty` and `class` variables.

```{r da-2-1, exercise=TRUE, exercise.lines = 5}

```

###

Let's say, for whatever reason, we wanted to remove all cars with their `manufacturer == "chevrolet"` from our data. We could do this using the `filter()` function and the `!=` symbol.  Try it!

Remember that this must be done BEFORE we use `select()`, which removes the `manufacturer` column altogether.

```{r da-2-2, exercise=TRUE, exercise.lines = 5}

```

```{r da-2-2-hint, eval=FALSE}
mpg %>%
  filter(...) %>%
  select(...)
```

###

Nice. Now, let's use `group_by()` to split up our data by `class`.

```{r da-2-3, exercise=TRUE, exercise.lines = 5}

```

###

Good stuff. Now, let's use `arrange()` to sort our `cty` values from lowest to highest within their respective classes.

Note that if you want to sort your data from highest to lowest, you can use `arrange(desc(...))`.

```{r da-2-4, exercise=TRUE, exercise.lines = 5}

```

###

Nice work. Now, let's use `summarize()` to calculate the `mean` of the `cty` values in each class. We can save our results as a new variable, called `ctyAverage`

```{r da-2-5, exercise=TRUE, exercise.lines = 5}

```

###

Good stuff. But let's say we're experimenting with a new type of gasoline that's twice as efficient as the traditional kind that the data in `mpg` was recorded with.

We could calculate the predicted City MPG with this new fuel using `mutate()`. Use `mutate()` to create a new variable, `ctyAverage2`, that's 2x `ctyAverage`.

```{r da-2-6, exercise=TRUE, exercise.lines = 5}

```

<!-- ### JSE - seems like too hard of a question... -->

<!-- Excellent work. Now, use what you've learned about data wrangling to replicate the result blow. -->

<!-- Information from the `compact` class in not in the final data set. -->

<!-- ```{r} -->
<!-- mpg %>% -->
<!--   filter(class != "compact") %>% -->
<!--   select(displ, manufacturer) %>% -->
<!--   group_by(manufacturer) %>% -->
<!--   summarize(displMedian = median(displ)) %>% -->
<!--   arrange(desc(displMedian)) -->
<!-- ``` -->

<!-- ```{r da-2-7, exercise=TRUE, exercise.lines = 5} -->

<!-- ``` -->

###
### Exercise 8
Let's do some data wrangling with the `qscores` tibble, which contains data from student course evaluations at Harvard.

Begin by using `select()` to pick out the `term`, `rating`, and `enrollment` variables.

```{r da-3-1, exercise=TRUE, exercise.lines = 5}

```

###

Nice. Let's use `filter()` so we only account for classes with a rating above 3.0.

```{r da-3-2, exercise=TRUE, exercise.lines = 5}

```

###

Good stuff. Now, let's use `group_by()` to divide our data by `term`.

```{r da-3-3, exercise=TRUE, exercise.lines = 5}

```

###

Nice. Let's say our goal was to calculate the average number of students in a Harvard class for each term a month into the term. But let's not take the average yet, there are still some factors we haven't accounted for yet.

Let's say on average, one tenth of all students drop a class by one month into the term, and two students are absent per class. We can calculate this by using `mutate()` to multiply `enrollment` by 9/10 and then subtract 2. Try it!

```{r da-3-4, exercise=TRUE, exercise.lines = 5}

```

###

Great. Now we can use `summarize()` to find the `mean` of `enrollment`. We can call this new variable `avgEnrollment`.

```{r da-3-5, exercise=TRUE, exercise.lines = 5}

```

###

Nice work. Let's also use `summarize()` to find the `min()` and `max()` of enrollment for each term. We can call these new variables `minEnrollment` and `maxEnrollment` respectively.

```{r da-3-6, exercise=TRUE, exercise.lines = 5}

```

<!-- ### JSE - also seems like too hard of a question... -->

<!-- Well done. Now, use what you've learned about data wrangling to recreate the data set below. -->

<!-- The data set only takes into account classes with an enrollment of at least 25. To calculate the devation from the median of a variable, use `mad()`, which stands for Median Absolute Deviation -->

<!-- ```{r} -->
<!-- qscores %>% -->
<!--   select(rating, department, enrollment) %>% -->
<!--   filter(enrollment > 25) %>% -->
<!--   group_by(department) %>% -->
<!--   summarise(medianRating = median(rating), -->
<!--             deviation = mad(rating)) -->
<!-- ``` -->

<!-- ```{r da-3-7, exercise=TRUE, exercise.lines = 5} -->

<!-- ``` -->

## Submit

Congrats on finishing your first Gov 50 tutorial! You're on your way to being a master in data visualization and wrangling! :)

```{r context="setup"}
submission_ui
```

```{r context="server"}
submission_server()
```
